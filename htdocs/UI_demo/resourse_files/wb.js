(function(){var A=(function(){var I={};var J=[];I.inc=function(L,K){return true};I.register=function(M,K){var O=M.split(".");var N=I;var L=null;while(L=O.shift()){if(O.length){if(N[L]===undefined){N[L]={}}N=N[L]}else{if(N[L]===undefined){try{N[L]=K(I)}catch(P){}}}}};I.regShort=function(K,L){if(I[K]!==undefined){throw"["+K+"] : short : has been register"}I[K]=L};I.IE=/msie/i.test(navigator.userAgent);I.E=function(K){if(typeof K==="string"){return document.getElementById(K)}else{return K}};I.C=function(K){var L;K=K.toUpperCase();if(K=="TEXT"){L=document.createTextNode("")}else{if(K=="BUFFER"){L=document.createDocumentFragment()}else{L=document.createElement(K)}}return L};I.log=function(K){J.push("["+((new Date()).getTime()%100000)+"]: "+K)};I.getErrorLogInformationList=function(K){return J.splice(0,K||J.length)};return I})();$Import=A.inc;A.register("core.str.trim",function(I){return function(M){if(typeof M!=="string"){throw"trim need a string as parameter"}var J=M.length;var L=0;var K=/(\u3000|\s|\t|\u00A0)/;while(L<J){if(!K.test(M.charAt(L))){break}L+=1}while(J>L){if(!K.test(M.charAt(J-1))){break}J-=1}return M.slice(L,J)}});A.register("core.evt.addEvent",function(I){return function(J,M,L){var K=I.E(J);if(K==null){return false}M=M||"click";if((typeof L).toLowerCase()!="function"){return}if(K.attachEvent){K.attachEvent("on"+M,L)}else{if(K.addEventListener){K.addEventListener(M,L,false)}else{K["on"+M]=L}}return true}});A.register("core.obj.parseParam",function(I){return function(L,K,J){var M,N={};K=K||{};for(M in L){N[M]=L[M];if(K[M]!=null){if(J){if(L.hasOwnProperty[M]){N[M]=K[M]}}else{N[M]=K[M]}}}return N}});A.register("core.arr.isArray",function(I){return function(J){return Object.prototype.toString.call(J)==="[object Array]"}});A.register("core.json.queryToJson",function(I){return function(L,P){var R=I.core.str.trim(L).split("&");var Q={};var K=function(T){if(P){return decodeURIComponent(T)}else{return T}};for(var N=0,O=R.length;N<O;N++){if(R[N]){var M=R[N].split("=");var J=M[0];var S=M[1];if(M.length<2){S=J;J="$nullName"}if(!Q[J]){Q[J]=K(S)}else{if(I.core.arr.isArray(Q[J])!=true){Q[J]=[Q[J]]}Q[J].push(K(S))}}}return Q}});A.register("core.obj.isEmpty",function(I){return function(M,L){var K=true;for(var J in M){if(L){K=false;break}else{if(M.hasOwnProperty(J)){K=false;break}}}return K}});A.register("core.util.cookie",function(J){var I={set:function(N,Q,P){var K=[];var O,M;var L=J.core.obj.parseParam({expire:null,path:"/",domain:null,secure:null,encode:true},P);if(L.encode==true){Q=escape(Q)}K.push(N+"="+Q);if(L.path!=null){K.push("path="+L.path)}if(L.domain!=null){K.push("domain="+L.domain)}if(L.secure!=null){K.push(L.secure)}if(L.expire!=null){O=new Date();M=O.getTime()+L.expire*3600000;O.setTime(M);K.push("expires="+O.toGMTString())}document.cookie=K.join(";")},get:function(M){M=M.replace(/([\.\[\]\$])/g,"\\$1");var L=new RegExp(M+"=([^;]*)?;","i");var N=document.cookie+";";var K=N.match(L);if(K){return K[1]||""}else{return""}},remove:function(K,L){L=L||{};L.expire=-10;I.set(K,"",L)}};return I});A.register("core.str.parseURL",function(I){return function(L){var K=/^(?:([A-Za-z]+):(\/{0,3}))?([0-9.\-A-Za-z]+\.[0-9A-Za-z]+)?(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/;var P=["url","scheme","slash","host","port","path","query","hash"];var N=K.exec(L);var O={};for(var M=0,J=P.length;M<J;M+=1){O[P[M]]=N[M]||""}return O}});A.register("core.json.jsonToQuery",function(I){var J=function(L,K){L=L==null?"":L;L=I.core.str.trim(L.toString());if(K){return encodeURIComponent(L)}else{return L}};return function(O,M){var P=[];if(typeof O=="object"){for(var L in O){if(L==="$nullName"){P=P.concat(O[L]);continue}if(O[L] instanceof Array){for(var N=0,K=O[L].length;N<K;N++){P.push(L+"="+J(O[L][N],M))}}else{if(typeof O[L]!="function"){P.push(L+"="+J(O[L],M))}}}}if(P.length){return P.join("&")}else{return""}}});A.register("core.util.URL",function(I){return function(N,K){var M=I.core.obj.parseParam({isEncodeQuery:false,isEncodeHash:false},K||{});var L={};var P=I.core.str.parseURL(N);var J=I.core.json.queryToJson(P.query);var O=I.core.json.queryToJson(P.hash);L.setParam=function(Q,R){J[Q]=R;return this};L.getParam=function(Q){return J[Q]};L.setParams=function(R){for(var Q in R){L.setParam(Q,R[Q])}return this};L.setHash=function(Q,R){O[Q]=R;return this};L.getHash=function(Q){return O[Q]};L.valueOf=L.toString=function(){var Q=[];var R=I.core.json.jsonToQuery(J,M.isEncodeQuery);var S=I.core.json.jsonToQuery(O,M.isEncodeQuery);if(P.scheme!=""){Q.push(P.scheme+":");Q.push(P.slash)}if(P.host!=""){Q.push(P.host);if(P.port!=""){Q.push(":");Q.push(P.port)}}Q.push("/");Q.push(P.path);if(R!=""){Q.push("?"+R)}if(S!=""){Q.push("#"+S)}return Q.join("")};return L}});A.register("core.util.browser",function(O){var I=navigator.userAgent.toLowerCase();var R=window.external||"";var K,L,M,S,N;var J=function(T){var U=0;return parseFloat(T.replace(/\./g,function(){return(U++==1)?"":"."}))};try{if((/windows|win32/i).test(I)){N="windows"}else{if((/macintosh/i).test(I)){N="macintosh"}else{if((/rhino/i).test(I)){N="rhino"}}}if((L=I.match(/applewebkit\/([^\s]*)/))&&L[1]){K="webkit";S=J(L[1])}else{if((L=I.match(/presto\/([\d.]*)/))&&L[1]){K="presto";S=J(L[1])}else{if(L=I.match(/msie\s([^;]*)/)){K="trident";S=1;if((L=I.match(/trident\/([\d.]*)/))&&L[1]){S=J(L[1])}}else{if(/gecko/.test(I)){K="gecko";S=1;if((L=I.match(/rv:([\d.]*)/))&&L[1]){S=J(L[1])}}}}}if(/world/.test(I)){M="world"}else{if(/360se/.test(I)){M="360"}else{if((/maxthon/.test(I))||typeof R.max_version=="number"){M="maxthon"}else{if(/tencenttraveler\s([\d.]*)/.test(I)){M="tt"}else{if(/se\s([\d.]*)/.test(I)){M="sogou"}}}}}}catch(Q){}var P={OS:N,CORE:K,Version:S,EXTRA:(M?M:false),IE:/msie/.test(I),OPERA:/opera/.test(I),MOZ:/gecko/.test(I)&&!/(compatible|webkit)/.test(I),IE5:/msie 5 /.test(I),IE55:/msie 5.5/.test(I),IE6:/msie 6/.test(I),IE7:/msie 7/.test(I),IE8:/msie 8/.test(I),IE9:/msie 9/.test(I),SAFARI:!/chrome\/([\d.]*)/.test(I)&&/\/([\d.]*) safari/.test(I),CHROME:/chrome\/([\d.]*)/.test(I),IPAD:/\(ipad/i.test(I),IPHONE:/\(iphone/i.test(I),ITOUCH:/\(itouch/i.test(I),MOBILE:/mobile/i.test(I)};return P});A.register("core.dom.isNode",function(I){return function(J){return(J!=undefined)&&Boolean(J.nodeName)&&Boolean(J.nodeType)}});A.register("core.util.hideContainer",function(K){var L;var I=function(){if(L){return}L=K.C("div");L.style.cssText="position:absolute;top:-9999px;left:-9999px;";document.getElementsByTagName("head")[0].appendChild(L)};var J={appendChild:function(M){if(K.core.dom.isNode(M)){I();L.appendChild(M)}},removeChild:function(M){if(K.core.dom.isNode(M)){L&&L.removeChild(M)}}};return J});window.WB2=window.WB2||{};WB2.Module={loginButton:{versions:{"1.0":{js:"loginButton{ver}.js?version=20120327",css:"/t3/style/css/common/card.css?version=20120327"},latest:{js:"loginButton.js?version=20120327",css:"/t4/appstyle/widget/css/loginButton/loginButton.css"}}},followButton:{versions:{"1.0":{js:"followButton{ver}.js",css:"/t3/style/css/common/card.css?version=20120924"},latest:{js:"followButton.js?version=20120330",css:"/t4/appstyle/widget/css/followButton/followButtonSdk.css"}}},publish:{versions:{"1.0":{js:"publish{ver}.js?version=20120703",css:"/t3/style/css/thirdpart/rlsbox.css?version=20120327"},"1.1":{js:"publish{ver}.js?version=20120731",css:"/t35/appstyle/opent/css/widgets/js_weibo_send/js_weibo_send.css"},latest:{js:"publish.js?version=20120916",css:"/t4/appstyle/widget/css/weiboPublish/weiboPublish.css"}}},hoverCard:{versions:{"1.0":{js:"hoverCard{ver}.js?version=20120327",css:"/t3/style/css/common/card.css?version=20120327"},latest:{js:"hoverCard.js?version=20120820",css:"/t4/appstyle/widget/css/weiboCard/weiboCard.css"}}},recommend:{versions:{"1.0":{js:"recommend{ver}.js"},latest:{js:"recommend.js",css:"/t3/style/css/thirdpart/interested.css"}}},selector:{versions:{"1.0":{js:"selector{ver}.js?version=20120327",css:"/t3/style/css/thirdpart/csuser.css"},latest:{js:"selector.js?version=20120424",css:"/t4/appstyle/widget/css/selector/selector.css"}}},iframeWidget:{versions:{"1.0":{js:"iframeWidget{ver}.js?version=20120918"},latest:{js:"iframeWidget.js?version=20121026"}}}};A.register("core.func.getType",function(I){return function(J){var K;return((K=typeof(J))=="object"?J==null&&"null"||Object.prototype.toString.call(J).slice(8,-1):K).toLowerCase()}});A.register("core.dom.ready",function(O){var K=[];var T=false;var S=O.core.func.getType;var P=O.core.util.browser;var N=O.core.evt.addEvent;var Q=function(){if(!T){if(document.readyState==="complete"){return true}}return T};var L=function(){if(T==true){return}T=true;for(var V=0,U=K.length;V<U;V++){if(S(K[V])==="function"){try{K[V].call()}catch(W){}}}K=[]};var I=function(){if(Q()){L();return}try{document.documentElement.doScroll("left")}catch(U){setTimeout(arguments.callee,25);return}L()};var J=function(){if(Q()){L();return}setTimeout(arguments.callee,25)};var M=function(){N(document,"DOMContentLoaded",L)};var R=function(){N(window,"load",L)};if(!Q()){if(O.IE&&window===window.top){I()}M();J();R()}return function(U){if(Q()){if(S(U)==="function"){U.call()}}else{K.push(U)}}});A.register("conf.api.wbml",function(I){window.WB2=window.WB2||{};return function(){var K=I.core.util.browser;var N=[{tagName:"login-button",widgetName:"connectButton"},{tagName:"publish",widgetName:"publish"},{tagName:"follow-button",widgetName:"iframeWidget"},{tagName:"share-button",widgetName:"iframeWidget"},{tagName:"list",widgetName:"iframeWidget"},{tagName:"show",widgetName:"iframeWidget"},{tagName:"comments",widgetName:"iframeWidget"},{tagName:"livestream",widgetName:"iframeWidget"},{tagName:"bulkfollow",widgetName:"iframeWidget"},{tagName:"hotlist",widgetName:"iframeWidget"}];var M=function(O,T){T=T||"wb";var P=navigator.userAgent.toLowerCase();var R=T+":"+O;if(K.IE){try{var S=document.namespaces;if(S&&S[T]){return document.getElementsByTagName(O).length==0?document.getElementsByTagName(R):document.getElementsByTagName(O)}}catch(Q){}return document.getElementsByTagName(R)}else{if(K.MOZ){return document.getElementsByTagNameNS(document.body.namespaceURI,R)}else{return document.getElementsByTagName(R)}}};var L=function(S,R){var Q=S.attributes;var O={};for(var P=Q.length-1;P>=0;P--){var T=Q[P];if(T.specified){O[Q[P].name]=Q[P].value}}O.dom=S;O.tagName=R;return O};var J=function(){var W=[];for(var R=0,V=N.length;R<V;R++){var O=N[R];var P=O.tagName;var S=O.widgetName;var U=M(P);for(var Q=0,T=U.length;Q<T;Q++){W.push({tag:P,widget:S,params:L(U[Q],P)})}}var V=W.length;if(V>0){WB2.anyWhere(function(Y){for(var aa=0,X=W.length;aa<X;aa++){var Z=W[aa];Y.widget[Z.widget](Z.params)}})}};(function(){try{if(document.namespaces&&!document.namespaces.item.wb){document.namespaces.add("wb")}}catch(O){}}());WB2.initCustomTag=J;I.core.dom.ready(function(){J()})}});var f;var z=[];var q=2;var a="https://api.weibo.com/"+q+"/oauth2/query";var g;var d="https://api.weibo.com/"+q+"/oauth2/authorize";var k={};var n=A.core.obj.parseParam,u=A.core.evt.addEvent,w=A.core.str.trim,B=A.core.util.browser,i=A.core.util.cookie,D=A.core.json.queryToJson;var H=function(M){var K={url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:null,onTimeout:null,responseName:null,varkey:"callback"};var N=-1;K=n(K,M);var L=K.responseName||("STK_"+Math.floor(Math.random()*1000)+new Date().getTime().toString());K.args[K.varkey]=L;var I=K.onComplete;var J=K.onTimeout;window[L]=function(O){if(N!=2&&I!=null){N=1;I(O)}};K.onComplete=null;K.onTimeout=function(){if(N!=1&&J!=null){N=2;J()}};return h(K)};var h=function(N){var M,I;var J={url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:null,onTimeout:null,uniqueID:null};J=n(J,N);if(J.url==""){throw"url is null"}M=document.createElement("script");M.charset="UTF-8";var O=/msie/i.test(navigator.userAgent);if(J.onComplete!=null){if(O){M.onreadystatechange=function(){if(M.readyState.toLowerCase()=="complete"||M.readyState.toLowerCase()=="loaded"){clearTimeout(I);J.onComplete();M.onreadystatechange=null}}}else{M.onload=function(){clearTimeout(I);J.onComplete();M.onload=null}}}var L=function(Q){if(Q){var P=[];for(var R in Q){P.push(R+"="+encodeURIComponent(w(Q[R])))}if(P.length){return P.join("&")}else{return""}}};var K=L(J.args);if(J.url.indexOf("?")==-1){if(K!=""){K="?"+K}}else{if(K!=""){K="&"+K}}M.src=J.url+K;document.getElementsByTagName("head")[0].appendChild(M);if(J.timeout>0&&J.onTimeout!=null){I=setTimeout(function(){J.onTimeout()},J.timeout)}return M};var C=function(){this.started=1;this.taskList=[];this.setStatue=function(I){this.started=I};this.start=function(){this.setStatue(0);var K,M,J,L;var I=this.taskList.shift();var M=I[0],J=I[1],L=I[2];M.apply(L,J)};this.next=function(){this.setStatue(1);if(this.taskList.length>0){this.start()}};this.add=function(K,J){var I={args:[],pointer:window,top:false};I=n(I,J);if(I.top){this.taskList.unshift([K,I.args,I.pointer])}else{this.taskList.push([K,I.args,I.pointer])}if(this.started){this.start()}}};var t=new C();function y(J){var I=WB2._config.version,L=WB2.anyWhere._instances,K=L[I];if(K){if(K.contentWindow._ready){K.contentWindow.request(J)}else{WB2.addToCallbacks(K.contentWindow,J)}}else{WB2.delayCall(J)}}function o(J){var I={requestType:"anywhere",callback:J};b(I)}function b(I){var K=I||{};var J=function(){y(K);t.next()};var L=function(M){if(k.bundle){M&&M()}else{h({url:WB2._config.host+"/open/api/js/api/bundle.js?version="+WB2._config.cdn_version,onComplete:function(){k.bundle=1;M&&M()}})}};t.add(L,{args:[J]})}function r(){var L=document.getElementsByTagName("script");var N=L.length,M=0,J,I,Q,K,O;if(N>0){J=L[M++];while(J){if(J.src.indexOf("api/js/wb.js")!=-1){I=J.src.split("?").pop();break}J=L[M++]}}I=I.toLowerCase();var P=D(I);Q=P.appkey||"";K=P.secret||"";O=P.version||1;return{appkey:Q,secret:K,version:O}}function p(L,K){var J,I;if(L!=null){if(K==true){z.unshift(L)}else{z.push(L)}}if(WB2.checkLogin()){for(J=0,I=z.length;J<I;J++){z[J].call()}z=[]}}function G(J){var I=A.core.util.URL(d),K=600,L=455;I.setParam("client_id",J.appkey);I.setParam("response_type","token");I.setParam("display","js");I.setParam("transport","html5");I.setParam("referer",encodeURI(document.location.href));g=window.open(I,"oauth_login_window","width="+K+",height="+L+",toolbar=no,menubar=no,resizable=no,status=no,left="+(screen.width-K)/2+",top="+(screen.height-L)/2);if(g){g.focus()}return}function e(I){if((/\api.weibo\.com$/).test(I.origin)){var J=I.data;J=unescape(J);J=D(J);if(J.error_code){J.success=-1;J.status=-1}else{J.success=1;J.status=1}m(J)}}function m(I){c(I.status);if(I.success==1){l.save(I);p()}else{z.pop()}}function s(I){p(I,true);if(!WB2.checkLogin()){if(window.postMessage&&!B.IE){G({appkey:WB2._config.appkey})}else{b({appkey:WB2._config.appkey,requestType:"login",callback:m})}}}function x(J){if(!WB2.checkLogin()){return}if(WB2._config.appkey!=null){l.del();c(-1);try{H({url:"https://api.weibo.com/2/account/end_session.json?source="+WB2._config.appkey,onComplete:function(K){J&&J(K.data)}})}catch(I){throw"JavaScript SDK: logout error"}}}function c(I){if(I==null){return}f=I}function F(){return f==1}var l={load:function(){if(!A.core.obj.isEmpty(WB2.oauthData)){return WB2.oauthData}else{var J=i.get("weibojs_"+WB2._config.appkey);J=unescape(J);var I=D(J);return I}},save:function(I){WB2.oauthData=I;var J="access_token="+(I.access_token||"")+"&refresh_token="+(I.refresh_token||"")+"&expires_in="+(I.expires_in||0)+"&uid="+(I.uid||"")+"&status="+(I.status||f||-1);i.set("weibojs_"+WB2._config.appkey,J,{path:"/",domain:document.domain})},del:function(){WB2.oauthData={};i.remove("weibojs_"+WB2._config.appkey,{path:"/",domain:document.domain})}};function j(J){var K=J||l.load();var L=K.access_token||"";var I=K.expires_in||"";if(L!=""){f=1}H({url:a,onComplete:function(M){M=M||{};if(M.status==1&&M.access_token){l.save(M)}f=M.status;p()},args:{source:WB2._config.appkey}})}var v=function(I){if(I.access_token){f=1;var J={status:f,access_token:I.access_token};l.save(J)}};window.WB2=window.WB2||{};WB2.widget={};var E=r();WB2._config={};WB2._config.version=E.version;WB2._config.appkey=E.appkey;WB2._config.secret=E.secret;WB2._config.host="http://js.t.sinajs.cn";WB2._config.cssHost="http://timg.sjs.sinajs.cn";WB2._config.cdn_version="20120816";WB2.oauthData={};WB2.init=v;WB2.login=s;WB2.logout=x;WB2.checkLogin=F;WB2.anyWhere=o;WB2.anyWhere._instances={};WB2.Cookie=l;WB2.regIframeRequest=b;WB2._config.appkey&&j();A.conf.api.wbml();if(window.postMessage&&!B.IE){A.core.evt.addEvent(window,"message",e)}})();